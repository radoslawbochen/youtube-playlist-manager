<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <style>
	.playlist {
	width:400px;
	background-color:gray;
	float:right;
  </style>
</head>
<script type="text/javascript" th:inline="javascript">
//<![CDATA[      
    var tag = document.createElement('script');
	tag.src = "https://www.youtube.com/iframe_api";
	var ScriptTag = document.getElementsByTagName('script')[0];
	ScriptTag.parentNode.insertBefore(tag, ScriptTag);

      var player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
        	height: '360',
            width: '640',
            videoId: 'YtF6p_w-cSc',
          	events: {
                'onReady': onPlayerReady, 
                'onStateChange': onPlayerStateChange,
            }
        });
      }

      function onPlayerReady(event) {
        event.target.playVideo();
      }
    
      function onPlayerStateChange(event) {

       	 //alert (player.getPlayerState() + ' = without if');
          if (event.data == YT.PlayerState.ENDED) { 
        	 player.cueVideoById('NMPVGxvaBxo')
        	 player.playVideo();
          	 //alert (player.getPlayerState() + ' = with if');
          }    
          
    	}
      //]]>
    </script>
<body>
<div id="player"></div>
<div class="usermadePlaylist">
	<div th:if="!${#lists.isEmpty(usermadePlaylistList)}" >
		<!-- <form action="#" th:action="@{/viewPlaylist}" th:object="${deleteList}" method="post" > -->
		<form action="#" method="post" th:action="@{/delete}" th:object="${users}"> 
		<!-- 
			<th:each items="${users.users}" var="user" varStatus="status">
			</th:each>
			 -->
			<table bgcolor="#404040">
			<tr th:each="userPlaylist, status : ${usermadePlaylistList}">
				<td width="70%" th:text="${userPlaylist.getLink()}"></td>
				<td width="30%" th:text="${userPlaylist.getTimesRepeated()}"></td>
				<td>
				<input type="checkbox" th:field="*{users[__${status.index}__].id}" th:value="${userPlaylist.id}"/> 
				</td>
			</tr>
			
		</table>
		<input type="hidden" th:value="${playlistName}" name="playlistName" />
		<input type="submit" name="deletePlaylistName" value="Delete" />
		</form>
	</div>
</div>

<div class="panel-group">
	<form method="post" th:action="@{/add}" th:object="${addList}">
	<div th:if="!${#lists.isEmpty(youtubePlaylistList)}" >	
  	<div th:each="youtubePlaylist, status : ${youtubePlaylistList}" >
  		<div class="panel panel-default">
    		<div class="panel-heading" >
      		<h4 class="panel-title">
        		<a data-toggle="collapse" th:href="|#collapse__${status.index + 1}__|"
        		 th:text="${youtubePlaylist.getName()}">
        		</a>
      		</h4>
    		</div>
    		<div th:id="|collapse__${status.index + 1}__|" class="panel-collapse collapse">
    		<div th:if="!${#lists.isEmpty(youtubePlaylist.getPlaylistItemLinkList())}" >
      		<ul class="list-group">
        		<li th:each="item, status : ${youtubePlaylist.getPlaylistItemLinkList()}" class="list-group-item">
        		<input type="checkbox" th:field="*{playlistLinkList[__${status.index}__].link}" th:value="${item}" th:text="${item}"/> 
        		</li>
        	</ul>
      		<div class="panel-footer">Footer</div>
      		</div>
    		</div>
  		</div>
  	</div>
	<input type="hidden" th:value="${playlistName}" name="playlistName" />
	<input type="submit" value="Add"/>
	</div>
</form>
</div>
  
<div>
<form method="post" th:action="@{/add}" th:object="${addList}">
	<div th:if="!${#lists.isEmpty(youtubePlaylistList)}" >
	<table bgcolor="#404040">
			<tr th:each="youtubePlaylist : ${youtubePlaylistList}">
				<td th:text="${youtubePlaylist.getName()}"></td>
				<td th:text="${youtubePlaylist.getVideosAmount()}"></td>
				<td th:text="${youtubePlaylist.getId()}"></td>			
				<td>
				<div th:if="!${#lists.isEmpty(youtubePlaylist.getPlaylistItemLinkList())}" >	
				<table>	
				<tr th:each="item, status : ${youtubePlaylist.getPlaylistItemLinkList()}">
					<td th:text="${item}" />
					<td>
					<input type="checkbox" th:field="*{playlistLinkList[__${status.index}__].link}" th:value="${item}"/> 
					</td>
				</tr>
				</table>
				</div>
				</td>
			</tr>
		</table>
	</div>
<input type="hidden" th:value="${playlistName}" name="playlistName" />
<input type="submit" value="Add"/>
</form>
</div>

</body>
</html>